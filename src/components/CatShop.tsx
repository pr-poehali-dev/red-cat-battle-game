import React, { useState } from 'react'
import { Card, CardContent } from '@/components/ui/card'
import { Badge } from '@/components/ui/badge'
import { Button } from '@/components/ui/button'
import Icon from '@/components/ui/icon'
import { GameStats } from '@/types/game'

interface Cat {
  id: string
  name: string
  level: number
  rarity: string
  rarityColor: string
  borderColor: string
  health: number
  maxHealth: number
  attack: number
  defense: number
  speed: number
  cost: number
  isFree: boolean
  image: string
  description: string
  detailedDescription: string
}

interface CatShopProps {
  gameStats: GameStats
  onPurchase: (catId: string, cost: number) => void
}

const CatShop: React.FC<CatShopProps> = ({ gameStats, onPurchase }) => {
  const [cats] = useState<Cat[]>([
    {
      id: 'murka',
      name: '–ö–æ—Ç—ë–Ω–æ–∫ –ú—É—Ä–∫–∞',
      level: 1,
      rarity: '–û–±—ã—á–Ω—ã–π',
      rarityColor: 'emerald',
      borderColor: 'emerald-500',
      health: 100,
      maxHealth: 100,
      attack: 15,
      defense: 8,
      speed: 12,
      cost: 0,
      isFree: true,
      image: '/img/33f4e16d-16ec-43d8-84f4-6fe73741ec6a.jpg',
      description: '–í–∞—à –ø–µ—Ä–≤—ã–π —Å–ø—É—Ç–Ω–∏–∫',
      detailedDescription: '–ú–∏–ª—ã–π —Ä—ã–∂–∏–π –∫–æ—Ç—ë–Ω–æ–∫ —Å –∑–µ–ª—ë–Ω—ã–º–∏ –≥–ª–∞–∑–∞–º–∏. –•–æ—Ç—å –æ–Ω –∏ –Ω–µ —Å–∞–º—ã–π —Å–∏–ª—å–Ω—ã–π, –∑–∞—Ç–æ –æ—á–µ–Ω—å –ø—Ä–µ–¥–∞–Ω–Ω—ã–π –∏ –≥–æ—Ç–æ–≤ —Å—Ä–∞–∂–∞—Ç—å—Å—è —Ä—è–¥–æ–º —Å –≤–∞–º–∏ –≤ –ª—é–±—ã—Ö –∫–æ—Å–º–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö!'
    },
    {
      id: 'tiger',
      name: '–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π –¢–∏–≥—Ä',
      level: 5,
      rarity: '–†–µ–¥–∫–∏–π',
      rarityColor: 'blue',
      borderColor: 'blue-500',
      health: 250,
      maxHealth: 250,
      attack: 35,
      defense: 20,
      speed: 25,
      cost: 500,
      isFree: false,
      image: '/img/5d4262b2-4440-4fc8-b5f6-95271ba37bc4.jpg',
      description: '–ú–æ–≥—É—á–∏–π –∫–æ—Å–º–∏—á–µ—Å–∫–∏–π –æ—Ö–æ—Ç–Ω–∏–∫',
      detailedDescription: '–í–µ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–∏–≥—Ä –∏–∑ –¥–∞–ª—ë–∫–∏—Ö –∑–≤—ë–∑–¥–Ω—ã—Ö —Å–∏—Å—Ç–µ–º. –ï–≥–æ –∫–æ—Å–º–∏—á–µ—Å–∫–∏–µ –ø–æ–ª–æ—Å—ã —Å–≤–µ—Ç—è—Ç—Å—è –≤ —Ç–µ–º–Ω–æ—Ç–µ, –∞ –µ–≥–æ –º–æ—â—å —Å–ø–æ—Å–æ–±–Ω–∞ –ø—Ä–æ–±–∏—Ç—å –±—Ä–æ–Ω—é –ª—é–±–æ–≥–æ –≤—Ä–∞–≥–∞!'
    },
    {
      id: 'phoenix',
      name: '–ó–≤—ë–∑–¥–Ω—ã–π –§–µ–Ω–∏–∫—Å',
      level: 10,
      rarity: '–≠–ø–∏—á–µ—Å–∫–∏–π',
      rarityColor: 'purple',
      borderColor: 'purple-500',
      health: 400,
      maxHealth: 400,
      attack: 60,
      defense: 35,
      speed: 45,
      cost: 1500,
      isFree: false,
      image: '/img/5dae8386-4f30-4ae8-af2b-94c7bb1f2cde.jpg',
      description: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –∑–∞—â–∏—Ç–Ω–∏–∫ –≥–∞–ª–∞–∫—Ç–∏–∫–∏',
      detailedDescription: '–ú–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∫–æ—Ç-—Ñ–µ–Ω–∏–∫—Å —Å –æ–≥–Ω–µ–Ω–Ω—ã–º–∏ –∫—Ä—ã–ª—å—è–º–∏. –°–ø–æ—Å–æ–±–µ–Ω –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ –≤ –±–æ—é –∏ –Ω–∞–Ω–æ—Å–∏—Ç—å –º–∞–≥–∏—á–µ—Å–∫–∏–π —É—Ä–æ–Ω. –ï–≥–æ –ø–ª–∞–º—è –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —É–≥–∞—Å–∞–µ—Ç!'
    },
    {
      id: 'dragon',
      name: '–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π –î—Ä–∞–∫–æ–Ω',
      level: 15,
      rarity: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π',
      rarityColor: 'yellow',
      borderColor: 'yellow-500',
      health: 600,
      maxHealth: 600,
      attack: 90,
      defense: 55,
      speed: 35,
      cost: 3000,
      isFree: false,
      image: '/img/d32781c4-bc1a-4096-9140-6bcef628f210.jpg',
      description: '–í–µ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ–≤–µ–ª–∏—Ç–µ–ª—å –∑–≤—ë–∑–¥',
      detailedDescription: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –¥—Ä–∞–∫–æ–Ω-–∫–æ—Ç, –≤–ª–∞–¥—ã–∫–∞ –≤—Å–µ—Ö –∫–æ—Å–º–∏—á–µ—Å–∫–∏—Ö —Å–æ–∑–≤–µ–∑–¥–∏–π. –ï–≥–æ –∑–æ–ª–æ—Ç–∞—è —á–µ—à—É—è –æ—Ç—Ä–∞–∂–∞–µ—Ç —Å–≤–µ—Ç –∑–≤—ë–∑–¥, –∞ –µ–≥–æ —Ä—ã–∫ —Å–ø–æ—Å–æ–±–µ–Ω –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Ä–µ–º—è!'
    }
  ])

  const handlePurchase = (cat: Cat) => {
    if (cat.isFree || gameStats.coins >= cat.cost) {
      onPurchase(cat.id, cat.cost)
    }
  }

  const canAfford = (cat: Cat) => {
    return cat.isFree || gameStats.coins >= cat.cost
  }

  const isOwned = (catId: string) => {
    return gameStats.ownedCats?.some(ownedCat => ownedCat.id === catId) || false
  }

  return (
    <div className="space-y-6">
      {/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */}
      <div className="text-center">
        <h1 className="text-3xl font-bold text-white mb-2">üõí –ú–∞–≥–∞–∑–∏–Ω –ö–æ—Ç–æ–≤</h1>
        <p className="text-white/70">–í—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ–µ–≥–æ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–≥–æ —Å–ø—É—Ç–Ω–∏–∫–∞</p>
      </div>

      {/* –ë–∞–ª–∞–Ω—Å –∏–≥—Ä–æ–∫–∞ */}
      <div className="flex items-center justify-center gap-2 bg-gradient-to-r from-yellow-500/20 to-orange-500/20 rounded-lg p-3 border border-yellow-500/30">
        <Icon name="Coins" size={20} className="text-yellow-400" />
        <span className="text-xl font-bold text-yellow-400">{gameStats.coins}</span>
        <span className="text-white/70">–º–æ–Ω–µ—Ç</span>
      </div>

      {/* –°–ø–∏—Å–æ–∫ –∫–æ—Ç–æ–≤ */}
      <div className="space-y-4">
        {cats.map(cat => (
          <Card key={cat.id} className={`bg-gradient-to-r from-slate-700/90 to-slate-800/90 backdrop-blur-sm border-2 border-${cat.borderColor} rounded-xl shadow-xl overflow-hidden`}>
            <CardContent className="p-0">
              <div className="flex">
                {/* –ê–≤–∞—Ç–∞—Ä –∫–æ—Ç–∞ */}
                <div className="w-32 h-32 flex-shrink-0 relative">
                  <div className={`w-full h-full bg-gradient-to-br from-${cat.rarityColor}-400/20 to-${cat.rarityColor}-500/20 p-2`}>
                    <img 
                      src={cat.image}
                      alt={cat.name}
                      className="w-full h-full rounded-lg object-cover"
                    />
                  </div>
                  <div className={`absolute top-2 right-2 w-6 h-6 rounded-full border-2 border-slate-800 flex items-center justify-center text-xs font-bold border-${cat.borderColor} bg-slate-800 text-${cat.rarityColor}-400`}>
                    {cat.level}
                  </div>
                </div>

                {/* –û–ø–∏—Å–∞–Ω–∏–µ –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ */}
                <div className="flex-1 p-4 space-y-3">
                  {/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */}
                  <div>
                    <h3 className="text-xl font-bold text-white">{cat.name}</h3>
                    <Badge className={`bg-gradient-to-r from-${cat.rarityColor}-400 to-${cat.rarityColor}-500 text-white font-bold border border-${cat.rarityColor}-500/50 text-xs`}>
                      {cat.rarity}
                    </Badge>
                  </div>

                  {/* –û–ø–∏—Å–∞–Ω–∏–µ */}
                  <p className="text-white/80 text-sm leading-relaxed">
                    {cat.detailedDescription}
                  </p>

                  {/* –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ */}
                  <div className="grid grid-cols-2 gap-2">
                    <div className="flex items-center gap-1">
                      <Icon name="Heart" size={14} className="text-red-400" />
                      <span className="text-xs text-white/70">{cat.health} HP</span>
                    </div>
                    <div className="flex items-center gap-1">
                      <Icon name="Sword" size={14} className="text-orange-400" />
                      <span className="text-xs text-white/70">{cat.attack} ATK</span>
                    </div>
                    <div className="flex items-center gap-1">
                      <Icon name="Shield" size={14} className="text-blue-400" />
                      <span className="text-xs text-white/70">{cat.defense} DEF</span>
                    </div>
                    <div className="flex items-center gap-1">
                      <Icon name="Zap" size={14} className="text-yellow-400" />
                      <span className="text-xs text-white/70">{cat.speed} SPD</span>
                    </div>
                  </div>

                  {/* –ö–Ω–æ–ø–∫–∞ –ø–æ–∫—É–ø–∫–∏ */}
                  <div className="pt-2">
                    {isOwned(cat.id) ? (
                      <div className="text-center bg-green-500/10 rounded-lg p-2 border border-green-500/30">
                        <div className="text-green-400 font-semibold text-sm">‚úÖ –£–∂–µ —É –≤–∞—Å!</div>
                      </div>
                    ) : cat.isFree ? (
                      <Button 
                        onClick={() => handlePurchase(cat)}
                        className={`w-full bg-gradient-to-r from-${cat.rarityColor}-500 to-${cat.rarityColor}-600 hover:from-${cat.rarityColor}-600 hover:to-${cat.rarityColor}-700 text-white font-bold py-2 px-4 rounded-lg transition-all duration-200`}
                      >
                        üéÅ –ü–æ–ª—É—á–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ
                      </Button>
                    ) : (
                      <div className="space-y-2">
                        <div className="flex items-center justify-center gap-2">
                          <Icon name="Coins" size={16} className="text-yellow-400" />
                          <span className="text-lg font-bold text-yellow-400">{cat.cost}</span>
                        </div>
                        <Button 
                          onClick={() => handlePurchase(cat)}
                          disabled={!canAfford(cat)}
                          className={`w-full ${canAfford(cat) 
                            ? `bg-gradient-to-r from-${cat.rarityColor}-500 to-${cat.rarityColor}-600 hover:from-${cat.rarityColor}-600 hover:to-${cat.rarityColor}-700` 
                            : 'bg-gray-500/50 cursor-not-allowed'
                          } text-white font-bold py-2 px-4 rounded-lg transition-all duration-200`}
                        >
                          {canAfford(cat) ? 'üí∞ –ö—É–ø–∏—Ç—å' : '‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç'}
                        </Button>
                      </div>
                    )}
                  </div>
                </div>
              </div>
            </CardContent>
          </Card>
        ))}
      </div>
    </div>
  )
}

export default CatShop